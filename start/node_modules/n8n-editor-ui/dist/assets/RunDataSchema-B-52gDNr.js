import{s as B,ep as R,er as V,K as j,N as C,cn as K,a3 as W,d9 as z}from"./index-DEwaaDne.js";import{_ as F,M as H}from"./TextWithHighlights.vue_vue_type_script_setup_true_lang-D-nZ3pe4.js";import{G as M,e as n,ag as D,l as s,m as c,I as l,p as I,U as S,M as d,R as i,T as P,F as J,a7 as O,J as L,r as U,O as A,S as q,u as G}from"./vendor-Dv5OeN6t.js";import{_ as w}from"./n8n-B6cfQsVX.js";import{D as Q}from"./NodeView-_cMwqhWw.js";import"./pinia-BAhPp3pQ.js";import"./axios-Mm4CS0gO.js";import"./flatted-DN8lQ2XG.js";import"./@vueuse/core-9E8Shwsg.js";import"./lodash-es-BxV-E8rt.js";import"./@n8n/permissions-BxxteU-C.js";import"./dateformat-B9ocXky7.js";import"./vue-i18n-Delvyc9x.js";import"./uuid-SoommWqA.js";import"./luxon-CLwAIbs0.js";import"./@n8n/codemirror-lang-sql-x14jMqbG.js";import"./@lezer/common-B6ct0j_v.js";import"./prettier-bS6l4Vb1.js";import"./@jsplumb/util-DS-9vq_E.js";import"./@jsplumb/core-CVBraiyY.js";import"./@jsplumb/common-CF-b-6-M.js";import"./@jsplumb/connector-bezier-BGU0Ovbw.js";import"./@jsplumb/browser-ui-BVF2KoJK.js";import"./codemirror-lang-html-n8n-DcTmlMkf.js";import"./@n8n/codemirror-lang-Qkdx7NoQ.js";import"./esprima-next-nhoSXAeq.js";import"./fast-json-stable-stringify-LluJPcs3.js";import"./timeago.js-CiyKClrF.js";import"./qrcode.vue-BGkPba5A.js";import"./vue3-touch-events-mV0oX_Sl.js";import"./chart.js-343vZi4M.js";import"./useExecutionDebugging-vMuoV-iO.js";import"./file-saver-B3jMAULB.js";import"./vue-json-pretty-4sRLvjgA.js";import"./dateFormatter-DfWOmXdP.js";import"./RunDataAi-D3971Kwm.js";import"./useWorkflowActivate-BLjS7M0I.js";import"./nodeCreator.store-DR3dfsvW.js";import"./collaboration.store-zz8xH0zY.js";import"./useViewStacks-BSagsijV.js";const X=["title"],Y=["data-value","data-name","data-path","data-depth"],Z=["id"],x=["for"],ee=M({__name:"RunDataSchemaItem",props:{schema:{},level:{},parent:{},subKey:{},paneType:{},mappingEnabled:{type:Boolean},draggingPath:{},distanceFromActive:{},node:{},search:{}},setup(v){const a=v,r=n(()=>Array.isArray(a.schema.value)),h=n(()=>r.value?a.schema.value:[]),m=n(()=>{var e;return((e=a.parent)==null?void 0:e.type)==="array"}),p=n(()=>a.level===0&&Array.isArray(a.schema.value)&&a.schema.value.every(e=>!Array.isArray(e.value))),y=n(()=>m.value?`[${a.schema.key}]`:a.schema.key),_=n(()=>m.value?`${a.schema.type}[${a.schema.key}]`:a.schema.key),g=n(()=>Array.isArray(a.schema.value)?"":B(a.schema.value,600,0)),b=n(()=>a.draggingPath===a.schema.path),t=e=>R({nodeName:a.node.name,distanceFromActive:a.distanceFromActive,path:e}),o=e=>`${e*.033}s`,u=e=>{switch(e){case"object":return"cube";case"array":return"list";case"string":case"null":return"font";case"number":return"hashtag";case"boolean":return"check-square";case"function":return"code";case"bigint":return"calculator";case"symbol":return"sun";case"undefined":return"ban";default:return V(e),""}};return(e,f)=>{var T;const E=D("font-awesome-icon"),N=D("run-data-schema-item",!0);return s(),c("div",{class:l(e.$style.item),"data-test-id":"run-data-schema-item"},[e.level>0||e.level===0&&!r.value?(s(),c("div",{key:0,title:e.schema.type,class:l({[e.$style.pill]:!0,[e.$style.mappable]:e.mappingEnabled,[e.$style.highlight]:b.value})},[I("span",{class:l(e.$style.label),"data-value":t(e.schema.path),"data-name":_.value,"data-path":e.schema.path,"data-depth":e.level,"data-target":"mappable"},[S(E,{icon:u(e.schema.type),size:"sm"},null,8,["icon"]),m.value?(s(),d(F,{key:0,content:(T=a.parent)==null?void 0:T.key,search:a.search},null,8,["content","search"])):i("",!0),y.value?(s(),d(F,{key:1,class:l({[e.$style.arrayIndex]:m.value}),content:y.value,search:a.search},null,8,["class","content","search"])):i("",!0)],10,Y)],10,X)):i("",!0),g.value?(s(),c("span",{key:1,class:l(e.$style.text)},P(g.value),3)):i("",!0),e.level>0&&r.value?(s(),c("input",{key:2,id:e.subKey,type:"checkbox",checked:""},null,8,Z)):i("",!0),e.level>0&&r.value?(s(),c("label",{key:3,class:l(e.$style.toggle),for:e.subKey},[S(E,{icon:"angle-up"})],10,x)):i("",!0),r.value?(s(),c("div",{key:4,class:l({[e.$style.sub]:!0,[e.$style.flat]:p.value})},[(s(!0),c(J,null,O(h.value,(k,$)=>(s(),d(N,{key:`${k.type}-${e.level}-${$}`,schema:k,level:e.level+1,parent:e.schema,"pane-type":e.paneType,"sub-key":`${e.paneType}_${k.type}-${e.level}-${$}`,"mapping-enabled":e.mappingEnabled,"dragging-path":e.draggingPath,"distance-from-active":e.distanceFromActive,node:e.node,style:L({transitionDelay:o($)}),search:e.search},null,8,["schema","level","parent","pane-type","sub-key","mapping-enabled","dragging-path","distance-from-active","node","style","search"]))),128))],2)):i("",!0)],2)}}}),ae="_item_x3781_1",te="_sub_x3781_14",se="_toggle_x3781_20",ne="_flat_x3781_41",re="_pill_x3781_51",oe="_mappable_x3781_51",le="_label_x3781_90",pe="_arrayIndex_x3781_95",ce="_text_x3781_101",ie={item:ae,sub:te,toggle:se,flat:ne,pill:re,mappable:oe,label:le,arrayIndex:pe,text:ce},me={$style:ie},ue=w(ee,[["__cssModules",me]]),de=M({__name:"RunDataSchema",props:{data:{},mappingEnabled:{type:Boolean},distanceFromActive:{default:0},runIndex:{},totalRuns:{},paneType:{},node:{},search:{}},setup(v){const a=v,r=U(""),h=j(),{getSchemaForExecutionData:m}=K(),p=n(()=>m(a.data)),y=n(()=>{const t=p.value.type==="object"||p.value.type==="array",o=Array.isArray(p.value.value)&&p.value.value.length===0;return t&&o}),_=n(()=>h.highlightDraggables),g=t=>{var o;(o=t==null?void 0:t.dataset)!=null&&o.path&&(r.value=t.dataset.path),h.resetMappingTelemetry()},b=t=>{r.value="",setTimeout(()=>{var e;const o=h.mappingTelemetry,u={src_node_type:(e=a.node)==null?void 0:e.type,src_field_name:t.dataset.name??"",src_nodes_back:a.distanceFromActive,src_run_index:a.runIndex,src_runs_total:a.totalRuns,src_field_nest_level:t.dataset.depth??0,src_view:"schema",src_element:t,success:!1,...o};W().run("runDataJson.onDragEnd",u),z.track("User dragged data for mapping",u,{withPostHog:!0})},1e3)};return(t,o)=>{const u=D("n8n-info-tip");return s(),c("div",{class:l([t.$style.schemaWrapper,{highlightSchema:_.value}])},[y.value?(s(),d(u,{key:0},{default:A(()=>[q(P(G(C).baseText("dataMapping.schemaView.emptyData")),1)]),_:1})):(s(),d(Q,{key:1,type:"mapping","target-data-key":"mappable",disabled:!t.mappingEnabled,onDragstart:g,onDragend:b},{preview:A(({canDrop:e,el:f})=>[f?(s(),d(H,{key:0,html:f.outerHTML,"can-drop":e},null,8,["html","can-drop"])):i("",!0)]),default:A(()=>[I("div",{class:l(t.$style.schema)},[S(ue,{schema:p.value,level:0,parent:null,"pane-type":t.paneType,"sub-key":`${p.value.type}-0-0`,"mapping-enabled":t.mappingEnabled,"dragging-path":r.value,"distance-from-active":t.distanceFromActive,node:t.node,search:t.search},null,8,["schema","pane-type","sub-key","mapping-enabled","dragging-path","distance-from-active","node","search"])],2)]),_:1},8,["disabled"]))],2)}}}),he="_schemaWrapper_3g73j_1",ye="_schema_3g73j_1",ge={schemaWrapper:he,schema:ye},ve={$style:ge},na=w(de,[["__cssModules",ve]]);export{na as default};
//# sourceMappingURL=RunDataSchema-B-52gDNr.js.map

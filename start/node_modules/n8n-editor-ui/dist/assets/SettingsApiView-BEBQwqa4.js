import{aU as T,u as k,G as C,i as g,cP as S,R as A,a as U,b as v,l as P,z as x}from"./index-DEwaaDne.js";import{m as I}from"./pinia-BAhPp3pQ.js";import{G as K,l,m as h,p as t,U as s,O as i,S as n,T as a,J as E,I as r,M as b,R as M,ag as o}from"./vendor-Dv5OeN6t.js";import{_ as D}from"./n8n-B6cfQsVX.js";import"./axios-Mm4CS0gO.js";import"./flatted-DN8lQ2XG.js";import"./@vueuse/core-9E8Shwsg.js";import"./lodash-es-BxV-E8rt.js";import"./@n8n/permissions-BxxteU-C.js";import"./dateformat-B9ocXky7.js";import"./vue-i18n-Delvyc9x.js";import"./uuid-SoommWqA.js";import"./luxon-CLwAIbs0.js";import"./@n8n/codemirror-lang-sql-x14jMqbG.js";import"./@lezer/common-B6ct0j_v.js";import"./prettier-bS6l4Vb1.js";import"./@jsplumb/util-DS-9vq_E.js";import"./@jsplumb/core-CVBraiyY.js";import"./@jsplumb/common-CF-b-6-M.js";import"./@jsplumb/connector-bezier-BGU0Ovbw.js";import"./@jsplumb/browser-ui-BVF2KoJK.js";import"./codemirror-lang-html-n8n-DcTmlMkf.js";import"./@n8n/codemirror-lang-Qkdx7NoQ.js";import"./esprima-next-nhoSXAeq.js";import"./fast-json-stable-stringify-LluJPcs3.js";import"./timeago.js-CiyKClrF.js";import"./qrcode.vue-BGkPba5A.js";import"./vue3-touch-events-mV0oX_Sl.js";import"./chart.js-343vZi4M.js";const z=K({name:"SettingsApiView",components:{CopyInput:T},setup(){return{...k(),...C(),...g()}},data(){return{loading:!1,mounted:!1,apiKey:"",swaggerUIEnabled:!1,apiDocsURL:""}},mounted(){if(!this.isPublicApiEnabled)return;this.getApiKey();const e=this.rootStore.baseUrl,c=this.settingsStore.publicApiPath,p=this.settingsStore.publicApiLatestVersion;this.swaggerUIEnabled=this.settingsStore.isSwaggerUIEnabled,this.apiDocsURL=this.swaggerUIEnabled?`${e}${c}/v${p}/docs`:`https://${S}/api/api-reference/`},computed:{...I(P,v,U,A,g),currentUser(){return this.usersStore.currentUser},isTrialing(){return this.cloudPlanStore.userIsTrialing},isLoadingCloudPlans(){return this.cloudPlanStore.state.loadingPlan},isPublicApiEnabled(){return this.settingsStore.isPublicApiEnabled}},methods:{onUpgrade(){this.uiStore.goToUpgrade("settings-n8n-api","upgrade-api","redirect")},async showDeleteModal(){await this.confirm(this.$locale.baseText("settings.api.delete.description"),this.$locale.baseText("settings.api.delete.title"),{confirmButtonText:this.$locale.baseText("settings.api.delete.button"),cancelButtonText:this.$locale.baseText("generic.cancel")})===x&&await this.deleteApiKey()},async getApiKey(){try{this.apiKey=await this.settingsStore.getApiKey()||""}catch(e){this.showError(e,this.$locale.baseText("settings.api.view.error"))}finally{this.mounted=!0}},async createApiKey(){this.loading=!0;try{this.apiKey=await this.settingsStore.createApiKey()||""}catch(e){this.showError(e,this.$locale.baseText("settings.api.create.error"))}finally{this.loading=!1,this.$telemetry.track("User clicked create API key button")}},async deleteApiKey(){try{await this.settingsStore.deleteApiKey(),this.showMessage({title:this.$locale.baseText("settings.api.delete.toast"),type:"success"}),this.apiKey=""}catch(e){this.showError(e,this.$locale.baseText("settings.api.delete.error"))}finally{this.$telemetry.track("User clicked delete API key button")}},onCopy(){this.$telemetry.track("User clicked copy API key button")}}}),V="_container_1xc1f_1",L="_header_1xc1f_5",R="_card_1xc1f_14",B="_hint_1xc1f_25",N={container:V,header:L,card:R,delete:"_delete_1xc1f_18",hint:B},O={key:0},G={class:"mb-s"},F=["textContent"],J=["textContent"];function j(e,c,p,H,Q,W){const m=o("n8n-heading"),y=o("i18n-t"),f=o("n8n-info-tip"),d=o("n8n-link"),$=o("CopyInput"),_=o("n8n-card"),w=o("n8n-text"),u=o("n8n-action-box");return l(),h("div",{class:r(e.$style.container)},[t("div",{class:r(e.$style.header)},[s(m,{size:"2xlarge"},{default:i(()=>[n(a(e.$locale.baseText("settings.api"))+" ",1),t("span",{style:E({fontSize:"var(--font-size-s)",color:"var(--color-text-light)"})}," ("+a(e.$locale.baseText("generic.beta"))+") ",5)]),_:1})],2),e.apiKey?(l(),h("div",O,[t("p",G,[s(f,{bold:!1},{default:i(()=>[s(y,{keypath:"settings.api.view.info",tag:"span"},{apiAction:i(()=>[t("a",{href:"https://docs.n8n.io/api",target:"_blank",textContent:a(e.$locale.baseText("settings.api.view.info.api"))},null,8,F)]),webhookAction:i(()=>[t("a",{href:"https://docs.n8n.io/integrations/core-nodes/n8n-nodes-base.webhook/",target:"_blank",textContent:a(e.$locale.baseText("settings.api.view.info.webhook"))},null,8,J)]),_:1})]),_:1})]),s(_,{class:r(["mb-4xs",e.$style.card])},{default:i(()=>[t("span",{class:r(e.$style.delete)},[s(d,{bold:!0,onClick:e.showDeleteModal},{default:i(()=>[n(a(e.$locale.baseText("generic.delete")),1)]),_:1},8,["onClick"])],2),t("div",null,[s($,{label:e.$locale.baseText("settings.api.view.myKey"),value:e.apiKey,"copy-button-text":e.$locale.baseText("generic.clickToCopy"),"toast-title":e.$locale.baseText("settings.api.view.copy.toast"),"redact-value":!0,onCopy:e.onCopy},null,8,["label","value","copy-button-text","toast-title","onCopy"])])]),_:1},8,["class"]),t("div",{class:r(e.$style.hint)},[s(w,{size:"small"},{default:i(()=>[n(a(e.$locale.baseText(`settings.api.view.${e.swaggerUIEnabled?"tryapi":"more-details"}`)),1)]),_:1}),n(" "+a(" ")+" "),s(d,{to:e.apiDocsURL,"new-window":!0,size:"small"},{default:i(()=>[n(a(e.$locale.baseText(`settings.api.view.${e.swaggerUIEnabled?"apiPlayground":"external-docs"}`)),1)]),_:1},8,["to"])],2)])):!e.isPublicApiEnabled&&e.isTrialing?(l(),b(u,{key:1,"data-test-id":"public-api-upgrade-cta",heading:e.$locale.baseText("settings.api.trial.upgradePlan.title"),description:e.$locale.baseText("settings.api.trial.upgradePlan.description"),"button-text":e.$locale.baseText("settings.api.trial.upgradePlan.cta"),"onClick:button":e.onUpgrade},null,8,["heading","description","button-text","onClick:button"])):e.mounted&&!e.isLoadingCloudPlans?(l(),b(u,{key:2,"button-text":e.$locale.baseText(e.loading?"settings.api.create.button.loading":"settings.api.create.button"),description:e.$locale.baseText("settings.api.create.description"),"onClick:button":e.createApiKey},null,8,["button-text","description","onClick:button"])):M("",!0)],2)}const q={$style:N},Ae=D(z,[["render",j],["__cssModules",q]]);export{Ae as default};
//# sourceMappingURL=SettingsApiView-BEBQwqa4.js.map

import{aH as _,e as V,af as l}from"./vendor-Dv5OeN6t.js";import{u as S,j as W,b as B,i as C,E as I,z as P,V as L,l as v,cA as h,F as A,w as O,G as U}from"./index-DEwaaDne.js";const H=()=>{const E=A(),T=_(),t=O(),N=U(),g=S(),s=W(),M=B(),c=C(),k=V(()=>M.isEnterpriseFeatureEnabled(I.DebugInEditor));return{applyExecutionData:async o=>{var x;const a=await s.getExecution(o),m=s.getCurrentWorkflow(),f=s.getNodes();if(!((x=a==null?void 0:a.data)!=null&&x.resultData))return;const{runData:b}=a.data.resultData,w=Object.keys(b),d=w.filter(e=>!f.some(i=>i.name===e)),y=Object.keys(s.workflow.pinData??{}),u=w.filter(e=>y.includes(e));if(u.length>0){const e=l("p",[t.baseText("nodeView.confirmMessage.debug.message"),l("ul",{class:"mt-l ml-l"},u.map(n=>l("li",n)))]);if(await N.confirm(e,t.baseText("nodeView.confirmMessage.debug.headline"),{type:"warning",confirmButtonText:t.baseText("nodeView.confirmMessage.debug.confirmButtonText"),cancelButtonText:t.baseText("nodeView.confirmMessage.debug.cancelButtonText"),dangerouslyUseHTMLString:!0,customClass:"matching-pinned-nodes-confirmation"})===P)u.forEach(n=>{const r=s.getNodeByName(n);r&&s.unpinData({node:r})});else{await T.push({name:L.EXECUTION_PREVIEW,params:{name:m.id,executionId:o}});return}}s.setWorkflowExecutionData(a);const p=f.filter(e=>!m.getParentNodes(e.name).length);let D=0;p.forEach(e=>{var n,r;const i=(r=(n=b[e.name])==null?void 0:n[0].data)==null?void 0:r.main[0];i&&(D++,s.pinData({node:e,data:i}))}),g.showToast({title:t.baseText("nodeView.showMessage.debug.title"),message:t.baseText("nodeView.showMessage.debug.content"),type:"info"}),d.length&&g.showToast({title:t.baseText("nodeView.showMessage.debug.missingNodes.title"),message:t.baseText("nodeView.showMessage.debug.missingNodes.content",{interpolate:{nodeNames:d.join(", ")}}),type:"warning"}),E.track("User clicked debug execution button",{instance_id:v().instanceId,exec_status:a.status,override_pinned_data:p.length===D,all_exec_data_imported:d.length===0})},handleDebugLinkClick:o=>{if(!k.value){c.openModalWithData({name:h,data:{title:t.baseText(c.contextBasedTranslationKeys.feature.unavailable.title),footerButtonAction:()=>{c.closeModal(h),c.goToUpgrade("debug","upgrade-debug")}}}),o.preventDefault(),o.stopPropagation();return}s.isInDebugMode=!1}}};export{H as u};
//# sourceMappingURL=useExecutionDebugging-vMuoV-iO.js.map

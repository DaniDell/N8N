{"version":3,"file":"SignupView-BKYxxBni.js","sources":["../../src/views/SignupView.vue"],"sourcesContent":["<template>\n\t<AuthView\n\t\t:form=\"FORM_CONFIG\"\n\t\t:form-loading=\"loading\"\n\t\t:subtitle=\"inviteMessage\"\n\t\t@submit=\"onSubmit\"\n\t/>\n</template>\n\n<script lang=\"ts\">\nimport AuthView from '@/views/AuthView.vue';\nimport { useToast } from '@/composables/useToast';\n\nimport { defineComponent } from 'vue';\nimport type { IFormBoxConfig } from '@/Interface';\nimport { VIEWS } from '@/constants';\nimport { mapStores } from 'pinia';\nimport { useUIStore } from '@/stores/ui.store';\nimport { useUsersStore } from '@/stores/users.store';\n\nexport default defineComponent({\n\tname: 'SignupView',\n\tcomponents: {\n\t\tAuthView,\n\t},\n\tsetup() {\n\t\treturn {\n\t\t\t...useToast(),\n\t\t};\n\t},\n\tdata() {\n\t\tconst FORM_CONFIG: IFormBoxConfig = {\n\t\t\ttitle: this.$locale.baseText('auth.signup.setupYourAccount'),\n\t\t\tbuttonText: this.$locale.baseText('auth.signup.finishAccountSetup'),\n\t\t\tinputs: [\n\t\t\t\t{\n\t\t\t\t\tname: 'firstName',\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tlabel: this.$locale.baseText('auth.firstName'),\n\t\t\t\t\t\tmaxlength: 32,\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tautocomplete: 'given-name',\n\t\t\t\t\t\tcapitalize: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'lastName',\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tlabel: this.$locale.baseText('auth.lastName'),\n\t\t\t\t\t\tmaxlength: 32,\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tautocomplete: 'family-name',\n\t\t\t\t\t\tcapitalize: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'password',\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tlabel: this.$locale.baseText('auth.password'),\n\t\t\t\t\t\ttype: 'password',\n\t\t\t\t\t\tvalidationRules: [{ name: 'DEFAULT_PASSWORD_RULES' }],\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tinfoText: this.$locale.baseText('auth.defaultPasswordRequirements'),\n\t\t\t\t\t\tautocomplete: 'new-password',\n\t\t\t\t\t\tcapitalize: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'agree',\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tlabel: this.$locale.baseText('auth.agreement.label'),\n\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn {\n\t\t\tFORM_CONFIG,\n\t\t\tloading: false,\n\t\t\tinviter: null as null | { firstName: string; lastName: string },\n\t\t\tinviterId: null as string | null,\n\t\t\tinviteeId: null as string | null,\n\t\t};\n\t},\n\tasync mounted() {\n\t\tconst inviterId = this.getQueryParameter('inviterId');\n\t\tconst inviteeId = this.getQueryParameter('inviteeId');\n\t\ttry {\n\t\t\tif (!inviterId || !inviteeId) {\n\t\t\t\tthrow new Error(this.$locale.baseText('auth.signup.missingTokenError'));\n\t\t\t}\n\t\t\tthis.inviterId = inviterId;\n\t\t\tthis.inviteeId = inviteeId;\n\n\t\t\tconst invite = await this.usersStore.validateSignupToken({ inviteeId, inviterId });\n\t\t\tthis.inviter = invite.inviter as { firstName: string; lastName: string };\n\t\t} catch (e) {\n\t\t\tthis.showError(e, this.$locale.baseText('auth.signup.tokenValidationError'));\n\t\t\tvoid this.$router.replace({ name: VIEWS.SIGNIN });\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapStores(useUIStore, useUsersStore),\n\t\tinviteMessage(): string {\n\t\t\tif (!this.inviter) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.$locale.baseText('settings.signup.signUpInviterInfo', {\n\t\t\t\tinterpolate: { firstName: this.inviter.firstName, lastName: this.inviter.lastName },\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tasync onSubmit(values: { [key: string]: string | boolean }) {\n\t\t\tif (!this.inviterId || !this.inviteeId) {\n\t\t\t\tthis.showError(\n\t\t\t\t\tnew Error(this.$locale.baseText('auth.signup.tokenValidationError')),\n\t\t\t\t\tthis.$locale.baseText('auth.signup.setupYourAccountError'),\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tthis.loading = true;\n\t\t\t\tawait this.usersStore.acceptInvitation({\n\t\t\t\t\t...values,\n\t\t\t\t\tinviterId: this.inviterId,\n\t\t\t\t\tinviteeId: this.inviteeId,\n\t\t\t\t} as {\n\t\t\t\t\tinviteeId: string;\n\t\t\t\t\tinviterId: string;\n\t\t\t\t\tfirstName: string;\n\t\t\t\t\tlastName: string;\n\t\t\t\t\tpassword: string;\n\t\t\t\t});\n\n\t\t\t\tif (values.agree === true) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait this.uiStore.submitContactEmail(values.email.toString(), values.agree);\n\t\t\t\t\t} catch {}\n\t\t\t\t}\n\n\t\t\t\tawait this.$router.push({ name: VIEWS.NEW_WORKFLOW });\n\t\t\t} catch (error) {\n\t\t\t\tthis.showError(error, this.$locale.baseText('auth.signup.setupYourAccountError'));\n\t\t\t}\n\t\t\tthis.loading = false;\n\t\t},\n\t\tgetQueryParameter(key: 'inviterId' | 'inviteeId'): string | null {\n\t\t\treturn !this.$route.query[key] || typeof this.$route.query[key] !== 'string'\n\t\t\t\t? null\n\t\t\t\t: (this.$route.query[key] as string);\n\t\t},\n\t},\n});\n</script>\n"],"names":["_sfc_main","defineComponent","AuthView","useToast","inviterId","inviteeId","invite","e","VIEWS","mapStores","useUIStore","useUsersStore","values","error","key","_resolveComponent","_openBlock","_createBlock","_component_AuthView","inviteMessage","onSubmit"],"mappings":"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"}
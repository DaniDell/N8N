import{d as k}from"./pinia-BAhPp3pQ.js";import{cu as O,cv as w,cw as _,cx as b,N as B,Q as U,bD as G}from"./index-DEwaaDne.js";import{v as D}from"./uuid-SoommWqA.js";import{B as M}from"./lodash-es-BxV-E8rt.js";import{r as A,e as z}from"./vendor-Dv5OeN6t.js";const Y=60,P=30,V=30,F=15,H=-20,g=-200,Q=-5;function W(e,t){let o=0,s=0;for(;o<e.length&&s<t.length;){const n=e.charAt(o).toLowerCase(),r=t.charAt(s).toLowerCase();n===r&&o++,++s}return e.length!==0&&t.length!==0&&o===e.length}function X(e,t){return C(e,t,0,0,null,[],256,0,0,5)}function C(e,t,o,s,n,r,u,a,l,d){let c=0;if(++l>=d)return{matched:!1,outScore:c};if(o===e.length||s===t.length)return{matched:!1,outScore:c};let i=!1,E=[],f=0,p=!0;for(;o<e.length&&s<t.length;){if(e[o].toLowerCase()===t[s].toLowerCase()){if(a>=u)return{matched:!1,outScore:c};p&&n&&(r=[...n],p=!1);const S=[],N=C(e,t,o,s+1,r,S,u,a,l,d),m=N.outScore;N.matched&&((!i||m>f)&&(E=[...S],f=m),i=!0),r[a++]=s,++o}++s}const h=o===e.length;if(h){c=100;let S=H*r[0];S=S<g?g:S,c+=S;const N=t.length-a;c+=Q*N;for(let m=0;m<a;m++){const T=r[m];if(m>0){const y=r[m-1];T===y+1&&(c+=Y)}if(T>0){const y=t[T-1],R=t[T];y!==y.toUpperCase()&&R!==R.toLowerCase()&&(c+=V),(y==="_"||y===" ")&&(c+=P)}else c+=F}return i&&(!h||f>c)?(r=[...E],c=f,{matched:!0,outScore:c}):h?{matched:!0,outScore:c}:{matched:!1,outScore:c}}return{matched:!1,outScore:c}}function j(e,t){if(e.hasOwnProperty(t))return e[t];const o=t.split(".");let s=e,n=0;for(;s&&n<o.length;){const r=o[n];s=s[r],n++}return s}function q(e,t,o){const s=t.reduce((n,r)=>{let u=[];o.forEach(({key:l,weight:d})=>{const c=j(r,l);Array.isArray(c)?u=u.concat(c.map(i=>({value:i,weight:d}))):typeof c=="string"&&u.push({value:c,weight:d})});const a=u.reduce((l,{value:d,weight:c})=>{if(!W(e,d))return l;const i=X(e,d);i.outScore*=c;const{matched:E,outScore:f}=i;return!l&&E||E&&l&&f>l.outScore?i:l},null);return a&&n.push({score:a.outScore,item:r}),n},[]);return s.sort((n,r)=>r.score-n.score),s}function I(e,t,o="node"){var n,r,u;const s={uuid:D(),key:e.name,subcategory:t??((u=(r=(n=e.codex)==null?void 0:n.subcategories)==null?void 0:r[O])==null?void 0:u[0])??w,properties:{...e},type:o};return s}function te(e){const t=[O,_];return e.reduce((o,s)=>{let n=[w];return t.forEach(r=>{var u,a,l,d;(a=(u=s.codex)==null?void 0:u.categories)!=null&&a.includes(r)&&(n=((d=(l=s.codex)==null?void 0:l.subcategories)==null?void 0:d[r])??[])}),n.forEach(r=>{o[r]||(o[r]=[]),o[r].push(I(s,r))}),o},{})}function v(e){return e.sort((t,o)=>{var r,u,a,l;if(t.type!=="node"||o.type!=="node")return 0;const s=((u=(r=t.properties)==null?void 0:r.displayName)==null?void 0:u.toLowerCase())||t.key,n=((l=(a=o.properties)==null?void 0:a.displayName)==null?void 0:l.toLowerCase())||o.key;return s.localeCompare(n,void 0,{sensitivity:"base"})})}function oe(e,t){const o=e.toLowerCase().replace("trigger","").trimEnd();return(q(o,t,[{key:"properties.displayName",weight:1.3},{key:"properties.codex.alias",weight:1}])||[]).map(({item:n})=>n)}function se(e){return e.map(t=>t.type==="section"?t.children:t).flat()}function L(e){var o,s,n,r,u;return e.type==="node"&&(s=(o=e.properties.codex)==null?void 0:o.categories)!=null&&s.includes(_)?!((u=(r=(n=e.properties.codex)==null?void 0:n.subcategories)==null?void 0:r[_])==null?void 0:u.includes(b)):!1}function re(e,t,o=!0){const s=t.filter(f=>typeof f=="object"),n=f=>f.reduce((p,h)=>{const S=s.find(m=>m.items.includes(h.key)),N=(S==null?void 0:S.key)??"other";return N&&(p[N]=[...p[N]??[],h]),p},{}),r=(f,p)=>f.map(h=>({type:"section",key:h.key,title:h.title,children:o?v(p[h.key]??[]):p[h.key]??[]})),u=e.filter(f=>!L(f)),a=e.filter(f=>L(f)),l=n(u),d=r(s,l),c=n(a),i=r(M(s,["title"]),c),E=[...d,...i].concat({type:"section",key:"other",title:B.baseText("nodeCreator.sectionNames.other"),children:v(l.other??[])}).filter(f=>f.type!=="section"||f.children.length>0);return E.length<=1?e:E}const ne=k(U.NODE_CREATOR,()=>{const e=A(G),t=A([]),o=A({}),s=A(!1),n=A(""),r=z(()=>Object.values(t.value).map(i=>I(i)));function u(i){t.value=i}function a(i){o.value=i}function l(i){s.value=i}function d(i){e.value=i}function c(i){n.value=i}return{openSource:n,selectedView:e,showScrim:s,mergedNodes:t,actions:o,setShowScrim:l,setSelectedView:d,setOpenSource:c,setActions:a,setMergeNodes:u,allNodeCreatorNodes:r}});export{te as a,v as b,se as f,re as g,L as i,oe as s,I as t,ne as u};
//# sourceMappingURL=nodeCreator.store-DR3dfsvW.js.map
